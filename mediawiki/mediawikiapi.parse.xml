<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
  <meta>
    <author>Ryan Lane</author>
    <sampleQuery>select * from {table} where query='search tag(s)'</sampleQuery>
    <description>Open search of Wikipedia Articles</description>
  </meta>
  <bindings>
    <select itemPath="" produces="XML">
      <urls>
        <url>http://{site}/w/api.php?action=parse&amp;format=xml</url>
      </urls>
      <inputs>
        <key id="site" type="xs:string" paramType="path" required="false" default="en.wikipedia.org"/>
        <key id="text" type="xs:string" paramType="query" required="true"/>
        <key id="title" type="xs:string" paramType="query" required="true"/>
      </inputs>
  	  <execute><![CDATA[
		var url = "http://"+site+"/w/api.php?action=parse&format=xml&text="+text,
			str = "select * from xml where url='" + url + "'",
			query = "";
			results  = <item></item>,
			titles = <title>{title}</title>;
		while ( query.results.api.parse.text === undefined ) {
			try {
				query = y.query(str);
			}
			catch (err) {}
		}
		results.appendChild( titles );
		results.appendChild( query.results.api.parse.text );
		response.object = results;
	  ]]></execute>
    </select>
  </bindings>
</table>